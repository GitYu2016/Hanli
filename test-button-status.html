<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>按钮状态测试</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            padding: 20px;
            background: #f5f5f5;
        }
        .test-section {
            background: white;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        .test-button {
            background: #ff6b35;
            color: white;
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            margin: 10px;
            transition: all 0.3s ease;
        }
        .test-button:hover {
            background: #e55a2b;
            transform: translateY(-2px);
        }
        .test-button:disabled {
            cursor: not-allowed;
            opacity: 0.7;
        }
        .status-ready { background: #ff6b35; }
        .status-collecting { background: #ffa726; }
        .status-completed { background: #4caf50; }
    </style>
</head>
<body>
    <h1>采集按钮状态测试</h1>
    
    <div class="test-section">
        <h3>按钮状态测试</h3>
        <p>点击按钮测试不同状态的变化：</p>
        
        <button id="testBtn" class="test-button">采集</button>
        
        <div style="margin-top: 20px;">
            <button onclick="testReady()" class="test-button">测试"采集"状态</button>
            <button onclick="testCollecting()" class="test-button">测试"采集中..."状态</button>
            <button onclick="testCompleted()" class="test-button">测试"已采集"状态</button>
        </div>
        
        <div style="margin-top: 20px;">
            <h4>状态说明：</h4>
            <ul>
                <li><strong>采集</strong> - 橙色，可点击，准备状态</li>
                <li><strong>采集中...</strong> - 黄色，不可点击，正在处理</li>
                <li><strong>已采集</strong> - 绿色，不可点击，完成状态</li>
            </ul>
        </div>
    </div>

    <div class="test-section">
        <h3>模拟采集流程</h3>
        <p>点击下面的按钮模拟完整的采集流程：</p>
        <button onclick="simulateCollection()" class="test-button">模拟采集流程</button>
        <div id="log" style="margin-top: 20px; padding: 10px; background: #f0f0f0; border-radius: 4px; font-family: monospace; white-space: pre-line;"></div>
    </div>

    <script>
        // 模拟按钮状态管理
        function updateButtonStatus(status) {
            const btn = document.getElementById('testBtn');
            
            switch (status) {
                case 'collecting':
                    btn.innerHTML = '采集中...';
                    btn.className = 'test-button status-collecting';
                    btn.disabled = true;
                    break;
                case 'completed':
                    btn.innerHTML = '已采集';
                    btn.className = 'test-button status-completed';
                    btn.disabled = true;
                    break;
                case 'ready':
                default:
                    btn.innerHTML = '采集';
                    btn.className = 'test-button status-ready';
                    btn.disabled = false;
                    break;
            }
        }

        function testReady() {
            updateButtonStatus('ready');
            log('按钮状态: 采集 (准备状态)');
        }

        function testCollecting() {
            updateButtonStatus('collecting');
            log('按钮状态: 采集中... (处理中)');
        }

        function testCompleted() {
            updateButtonStatus('completed');
            log('按钮状态: 已采集 (完成状态)');
        }

        function log(message) {
            const logDiv = document.getElementById('log');
            const timestamp = new Date().toLocaleTimeString();
            logDiv.textContent += `[${timestamp}] ${message}\n`;
            logDiv.scrollTop = logDiv.scrollHeight;
        }

        async function simulateCollection() {
            log('开始模拟采集流程...');
            
            // 1. 开始采集
            updateButtonStatus('collecting');
            log('1. 按钮状态: 采集中...');
            
            // 2. 模拟JSON保存
            await sleep(1000);
            log('2. JSON数据已保存到App');
            
            // 3. 模拟App唤起
            await sleep(500);
            log('3. App已唤起');
            
            // 4. 模拟图片下载
            await sleep(2000);
            log('4. 开始下载图片...');
            
            // 5. 模拟下载完成
            await sleep(1500);
            log('5. 图片下载完成！');
            
            // 6. 更新按钮状态
            updateButtonStatus('completed');
            log('6. 按钮状态: 已采集');
            
            log('采集流程模拟完成！');
        }

        function sleep(ms) {
            return new Promise(resolve => setTimeout(resolve, ms));
        }

        // 初始化
        log('按钮状态测试页面已加载');
        log('点击按钮测试不同状态');
    </script>
</body>
</html>
