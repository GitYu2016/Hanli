<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SidebarItem 组件测试</title>
    <link rel="stylesheet" href="../../renderer/theme/light/colors.css">
    <link rel="stylesheet" href="../../renderer/theme/dark/colors.css">
    <link rel="stylesheet" href="../../renderer/icons-fixed.css">
    <style>
        body {
            margin: 0;
            padding: 20px;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: var(--color-body-bg-default);
            color: var(--color-primary);
            transition: background-color 0.2s ease;
        }

        .theme-dark {
            background: var(--color-body-bg-default);
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        .section {
            margin-bottom: 30px;
            padding: 20px;
            background: var(--color-background-normal);
            border-radius: 6px;
            border: 1px solid var(--color-border-normal);
        }

        .section h2 {
            margin-top: 0;
            margin-bottom: 20px;
            color: var(--color-primary);
        }

        .theme-toggle {
            margin-bottom: 20px;
        }

        .theme-toggle button {
            padding: 8px 16px;
            border: 1px solid var(--color-border-normal);
            border-radius: 6px;
            background: var(--color-background-normal);
            color: var(--color-primary);
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .theme-toggle button:hover {
            background: var(--color-background-focused);
            border-color: var(--color-border-focused);
        }

        .demo-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-top: 20px;
        }

        .demo-sidebar {
            background: var(--color-background-normal);
            border: 1px solid var(--color-border-normal);
            border-radius: 6px;
            padding: 10px;
            min-height: 300px;
        }

        .demo-sidebar h3 {
            margin: 0 0 15px 0;
            font-size: 16px;
            color: var(--color-primary);
            padding: 10px;
            border-bottom: 1px solid var(--color-border-normal);
        }

        .controls {
            background: var(--color-background-normal);
            border: 1px solid var(--color-border-normal);
            border-radius: 6px;
            padding: 15px;
        }

        .controls h3 {
            margin: 0 0 15px 0;
            font-size: 16px;
            color: var(--color-primary);
        }

        .control-group {
            margin-bottom: 15px;
        }

        .control-group label {
            display: block;
            margin-bottom: 5px;
            font-size: 14px;
            color: var(--color-secondary);
        }

        .control-group input,
        .control-group select {
            width: 100%;
            padding: 8px 12px;
            border: 1px solid var(--color-border-normal);
            border-radius: 4px;
            background: var(--color-background-normal);
            color: var(--color-primary);
            font-size: 14px;
        }

        .control-group input:focus,
        .control-group select:focus {
            outline: none;
            border-color: var(--color-border-focused);
        }

        .control-group button {
            padding: 6px 12px;
            border: 1px solid var(--color-border-normal);
            border-radius: 4px;
            background: var(--color-background-normal);
            color: var(--color-primary);
            cursor: pointer;
            font-size: 12px;
            margin-right: 8px;
            margin-bottom: 8px;
            transition: all 0.2s ease;
        }

        .control-group button:hover {
            background: var(--color-background-focused);
            border-color: var(--color-border-focused);
        }

        .control-group button.active {
            background: var(--color-background-focused);
            border-color: var(--color-border-focused);
        }

        .log {
            background: var(--color-background-normal);
            border: 1px solid var(--color-border-normal);
            border-radius: 6px;
            padding: 15px;
            font-family: 'Monaco', 'Menlo', monospace;
            font-size: 12px;
            color: var(--color-secondary);
            max-height: 200px;
            overflow-y: auto;
        }

        .log h3 {
            margin: 0 0 10px 0;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            color: var(--color-primary);
        }

        .log-entry {
            margin: 2px 0;
            padding: 2px 0;
        }

        .log-entry.click {
            color: var(--color-info);
        }

        .log-entry.hover {
            color: var(--color-warning);
        }

        .log-entry.state {
            color: var(--color-success);
        }

        .system-settings-demo {
            display: flex;
            gap: 20px;
        }

        .settings-sidebar {
            width: 250px;
            background: var(--color-background-normal);
            border: 1px solid var(--color-border-normal);
            border-radius: 6px;
            padding: 10px;
        }

        .settings-content {
            flex: 1;
            background: var(--color-background-normal);
            border: 1px solid var(--color-border-normal);
            border-radius: 6px;
            padding: 20px;
        }

        .settings-content h3 {
            margin: 0 0 15px 0;
            color: var(--color-primary);
        }

        .settings-content p {
            color: var(--color-secondary);
            line-height: 1.6;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>SidebarItem 组件测试</h1>
        
        <div class="section">
            <h2>主题切换</h2>
            <div class="theme-toggle">
                <button onclick="toggleTheme()">切换主题</button>
                <span id="current-theme">当前主题: 亮色</span>
            </div>
        </div>

        <div class="section">
            <h2>基础功能测试</h2>
            <div class="demo-grid">
                <div class="demo-sidebar">
                    <h3>基础侧边栏项目</h3>
                    <div id="basic-sidebar-items"></div>
                </div>
                
                <div class="controls">
                    <h3>交互控制</h3>
                    <div class="control-group">
                        <label>选中项目</label>
                        <div>
                            <button onclick="setActiveItem('item1')">项目1</button>
                            <button onclick="setActiveItem('item2')">项目2</button>
                            <button onclick="setActiveItem('item3')">项目3</button>
                            <button onclick="clearActive()">清除选中</button>
                        </div>
                    </div>
                    
                    <div class="control-group">
                        <label>禁用/启用项目</label>
                        <div>
                            <button onclick="toggleDisabled('item2')">切换项目2</button>
                            <button onclick="toggleDisabled('item3')">切换项目3</button>
                        </div>
                    </div>
                    
                    <div class="control-group">
                        <label>更新徽章</label>
                        <div>
                            <button onclick="setBadge('item1', '5')">项目1徽章</button>
                            <button onclick="setBadge('item2', 'NEW')">项目2徽章</button>
                            <button onclick="removeBadge('item1')">移除徽章</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="section">
            <h2>系统设置侧边栏演示</h2>
            <div class="system-settings-demo">
                <div class="settings-sidebar">
                    <h3>设置</h3>
                    <div id="settings-sidebar-items"></div>
                </div>
                
                <div class="settings-content">
                    <h3 id="settings-title">通用设置</h3>
                    <p id="settings-description">在这里可以配置应用程序的通用设置选项。</p>
                </div>
            </div>
        </div>

        <div class="section">
            <h2>事件日志</h2>
            <div class="log">
                <h3>交互日志</h3>
                <div id="event-log"></div>
            </div>
        </div>
    </div>

    <script src="../../renderer/components/Common/List/SidebarItem.js"></script>
    <script>
        let currentTheme = 'light';
        let sidebarItems = {};
        let activeItemId = null;

        // 初始化
        document.addEventListener('DOMContentLoaded', function() {
            initBasicSidebar();
            initSettingsSidebar();
        });

        /**
         * 初始化基础侧边栏
         */
        function initBasicSidebar() {
            const container = document.getElementById('basic-sidebar-items');
            
            // 创建基础侧边栏项目
            const items = [
                {
                    id: 'item1',
                    label: '首页',
                    icon: 'ph-house',
                    badge: '3'
                },
                {
                    id: 'item2',
                    label: '产品库',
                    icon: 'ph-package',
                    subtitle: '管理产品信息'
                },
                {
                    id: 'item3',
                    label: '设置',
                    icon: 'ph-gear',
                    indentLevel: 1
                }
            ];

            items.forEach(itemConfig => {
                const item = new SidebarItem({
                    ...itemConfig,
                    onClick: (id, label) => {
                        logEvent(`点击: ${label} (${id})`, 'click');
                        setActiveItem(id);
                    },
                    onHover: (id, label, action) => {
                        logEvent(`悬浮: ${label} (${action})`, 'hover');
                    }
                });

                sidebarItems[itemConfig.id] = item;
                container.innerHTML += item.render();
                item.bindEvents(container);
            });
        }

        /**
         * 初始化系统设置侧边栏
         */
        function initSettingsSidebar() {
            const container = document.getElementById('settings-sidebar-items');
            
            const settingsItems = [
                {
                    id: 'settings-general',
                    label: '通用',
                    icon: 'ph-gear',
                    onClick: () => showSettingsContent('通用设置', '在这里可以配置应用程序的通用设置选项。')
                },
                {
                    id: 'settings-appearance',
                    label: '外观',
                    icon: 'ph-palette',
                    onClick: () => showSettingsContent('外观设置', '自定义应用程序的外观和主题设置。')
                },
                {
                    id: 'settings-notifications',
                    label: '通知',
                    icon: 'ph-bell',
                    badge: '2',
                    onClick: () => showSettingsContent('通知设置', '管理应用程序的通知偏好设置。')
                },
                {
                    id: 'settings-advanced',
                    label: '高级',
                    icon: 'ph-wrench',
                    subtitle: '开发者选项',
                    onClick: () => showSettingsContent('高级设置', '高级配置选项，仅供有经验的用户使用。')
                }
            ];

            settingsItems.forEach(itemConfig => {
                const item = new SidebarItem({
                    ...itemConfig,
                    onClick: (id, label) => {
                        logEvent(`设置项点击: ${label}`, 'click');
                        setSettingsActive(id);
                        itemConfig.onClick();
                    }
                });

                sidebarItems[itemConfig.id] = item;
                container.innerHTML += item.render();
                item.bindEvents(container);
            });

            // 默认选中第一个
            setSettingsActive('settings-general');
            showSettingsContent('通用设置', '在这里可以配置应用程序的通用设置选项。');
        }

        /**
         * 设置激活项目
         */
        function setActiveItem(itemId) {
            // 清除之前的激活状态
            Object.values(sidebarItems).forEach(item => {
                if (item.id !== itemId) {
                    item.setInactive();
                }
            });

            // 设置新的激活状态
            if (sidebarItems[itemId]) {
                sidebarItems[itemId].setActive();
                activeItemId = itemId;
                logEvent(`激活项目: ${itemId}`, 'state');
            }
        }

        /**
         * 设置设置项激活状态
         */
        function setSettingsActive(itemId) {
            // 只处理设置相关的项目
            const settingsIds = ['settings-general', 'settings-appearance', 'settings-notifications', 'settings-advanced'];
            
            settingsIds.forEach(id => {
                if (sidebarItems[id]) {
                    if (id === itemId) {
                        sidebarItems[id].setActive();
                    } else {
                        sidebarItems[id].setInactive();
                    }
                }
            });
        }

        /**
         * 清除激活状态
         */
        function clearActive() {
            Object.values(sidebarItems).forEach(item => {
                item.setInactive();
            });
            activeItemId = null;
            logEvent('清除所有激活状态', 'state');
        }

        /**
         * 切换禁用状态
         */
        function toggleDisabled(itemId) {
            if (sidebarItems[itemId]) {
                const currentState = sidebarItems[itemId].isDisabled;
                sidebarItems[itemId].setDisabled(!currentState);
                logEvent(`${itemId} 禁用状态: ${!currentState}`, 'state');
            }
        }

        /**
         * 设置徽章
         */
        function setBadge(itemId, badge) {
            if (sidebarItems[itemId]) {
                sidebarItems[itemId].setBadge(badge);
                logEvent(`${itemId} 设置徽章: ${badge}`, 'state');
            }
        }

        /**
         * 移除徽章
         */
        function removeBadge(itemId) {
            if (sidebarItems[itemId]) {
                sidebarItems[itemId].setBadge(null);
                logEvent(`${itemId} 移除徽章`, 'state');
            }
        }

        /**
         * 显示设置内容
         */
        function showSettingsContent(title, description) {
            document.getElementById('settings-title').textContent = title;
            document.getElementById('settings-description').textContent = description;
        }

        /**
         * 记录事件日志
         */
        function logEvent(message, type = 'info') {
            const log = document.getElementById('event-log');
            const timestamp = new Date().toLocaleTimeString();
            const entry = document.createElement('div');
            entry.className = `log-entry ${type}`;
            entry.textContent = `[${timestamp}] ${message}`;
            log.appendChild(entry);
            log.scrollTop = log.scrollHeight;
        }

        /**
         * 切换主题
         */
        function toggleTheme() {
            currentTheme = currentTheme === 'light' ? 'dark' : 'light';
            
            if (currentTheme === 'dark') {
                document.documentElement.classList.add('theme-dark');
                document.documentElement.classList.remove('theme-light');
            } else {
                document.documentElement.classList.add('theme-light');
                document.documentElement.classList.remove('theme-dark');
            }
            
            document.getElementById('current-theme').textContent = `当前主题: ${currentTheme === 'light' ? '亮色' : '暗色'}`;
        }
    </script>
</body>
</html>
