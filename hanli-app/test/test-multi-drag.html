<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>多选媒体文件拖动复制测试</title>
    <link rel="stylesheet" href="../renderer/styles.css">
    <style>
        body {
            padding: 20px;
            background: var(--color-background);
            color: var(--color-foreground);
        }
        
        .test-container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .test-header {
            text-align: center;
            margin-bottom: 30px;
        }
        
        .test-instructions {
            background: var(--color-muted);
            padding: 20px;
            border-radius: var(--radius-medium);
            margin-bottom: 30px;
        }
        
        .test-instructions h3 {
            margin-bottom: 15px;
            color: var(--color-primary);
        }
        
        .test-instructions ol {
            margin-left: 20px;
        }
        
        .test-instructions li {
            margin-bottom: 8px;
            line-height: 1.5;
        }
        
        .drop-zone {
            border: 2px dashed var(--color-primary);
            border-radius: var(--radius-medium);
            padding: 40px;
            text-align: center;
            color: var(--color-text-secondary);
            background: var(--color-muted);
            margin-bottom: 30px;
            transition: all 0.3s ease;
        }
        
        .drop-zone.drag-over {
            border-color: var(--color-primary);
            background: var(--color-primary-light);
            color: var(--color-primary);
        }
        
        .media-container {
            min-height: 400px;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <div class="test-header">
            <h1>多选媒体文件拖动复制功能测试</h1>
        </div>
        
        <div class="test-instructions">
            <h3>使用说明：</h3>
            <ol>
                <li>选择多个媒体文件（点击选择，按住Shift键多选）</li>
                <li>拖拽选中的媒体文件到下面的拖拽区域</li>
                <li>文件将被复制到桌面文件夹</li>
                <li>观察拖拽过程中的视觉反馈和提示</li>
            </ol>
        </div>
        
        <div class="drop-zone" data-target-path="~/Desktop">
            <h3>拖拽区域</h3>
            <p>将选中的媒体文件拖拽到这里进行复制</p>
            <p>文件将复制到桌面文件夹</p>
        </div>
        
        <div class="media-container" id="media-card-container">
            <!-- 媒体卡片将在这里渲染 -->
        </div>
    </div>

    <!-- 加载必要的脚本 -->
    <script src="../renderer/components/Detail/MediaSelection.js"></script>
    <script src="../renderer/components/Detail/MediaCard.js"></script>
    
    <script>
        // 模拟媒体数据
        const testMediaItems = [
            {
                type: 'image',
                url: 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSIjZjBmMGYwIi8+PHRleHQgeD0iNTAlIiB5PSI1MCUiIGZvbnQtZmFtaWx5PSJBcmlhbCIgZm9udC1zaXplPSIxNCIgZmlsbD0iIzY2NiIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZHk9Ii4zZW0iPuWbvueJh+WKoOi9vTwvdGV4dD48L3N2Zz4=',
                name: '测试图片1.jpg',
                width: 200,
                height: 200,
                fileSize: 1024000,
                path: '/test/path/image1.jpg'
            },
            {
                type: 'image',
                url: 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSIjZTBmMGZmIi8+PHRleHQgeD0iNTAlIiB5PSI1MCUiIGZvbnQtZmFtaWx5PSJBcmlhbCIgZm9udC1zaXplPSIxNCIgZmlsbD0iIzY2NiIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZHk9Ii4zZW0iPuWbvueJh+WKoOi9vTI8L3RleHQ+PC9zdmc+',
                name: '测试图片2.jpg',
                width: 200,
                height: 200,
                fileSize: 2048000,
                path: '/test/path/image2.jpg'
            },
            {
                type: 'video',
                url: 'data:video/mp4;base64,AAAAIGZ0eXBpc29tAAACAGlzb21pc28yYXZjMWF2YzEAAAAIZnJlZQAAArxtZGF0AAACrgYF//+q3EXpvebZSLeWLNgg2SPu73gyNjQgLSBjb3JlIDE1NSByMjkxNyAwYjg5ZDkzIC0gSC4yNjQvTVBFRy00IEFWQyBjb2RlYyAtIENvcHlsZWZ0IDIwMDMtMjAxOCAtIGh0dHA6Ly93d3cudmlkZW9sYW4ub3JnL3gyNjQuaHRtbCAtIG9wdGlvbnM6IGNhYmFjPTEgcmVmPTMgZGVibG9jaz0xOjA6MCBhbmFseXNlPTB4MzoweDExMyBtZT1oZXggc3VibWU9NyBwc3k9MSBwc3lfcmQ9MS4wMDowLjAwIG1peGVkX3JlZj0xIG1lX3JhbmdlPTE2IGNocm9tYV9tZT0xIHRyZWxsaXM9MSA4eDhkY3Q9MSBjcW09MCBkZWFkem9uZT0yMSwxMSBmYXN0X3Bza2lwPTEgY2hyb21hX3FwX29mZnNldD0tMiB0aHJlYWRzPTEgbG9va2FoZWFkX3RocmVhZHM9MSBzbGljZWRfdGhyZWFkcz0wIG5yPTAgZGVjaW1hdGU9MSBpbnRlcmxhY2VkPTAgYmx1cmF5X2NvbXBhdD0wIGNvbnN0cmFpbmVkX2ludHJhPTAgYmZyYW1lcz0zIGJfcHlyYW1pZD0yIGJfYWRhcHQ9MSBiX2JpYXM9MCBkaXJlY3Q9MSB3ZWlnaHRiPTEgb3Blbl9nb3A9MCB3ZWlnaHRwPTIga2V5aW50PTI1MCBrZXlpbnRfbWluPTEgc2NlbmVjdXQ9NDA=',
                name: '测试视频1.mp4',
                fileSize: 5242880,
                path: '/test/path/video1.mp4'
            },
            {
                type: 'image',
                url: 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSIjZmZkMGYwIi8+PHRleHQgeD0iNTAlIiB5PSI1MCUiIGZvbnQtZmFtaWx5PSJBcmlhbCIgZm9udC1zaXplPSIxNCIgZmlsbD0iIzY2NiIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZHk9Ii4zZW0iPuWbvueJh+WKoOi9vTM8L3RleHQ+PC9zdmc+',
                name: '测试图片3.jpg',
                width: 200,
                height: 200,
                fileSize: 1536000,
                path: '/test/path/image3.jpg'
            }
        ];

        // 模拟Electron API
        window.electronAPI = {
            fileAPI: {
                copyFilesToFolder: async (items, targetPath) => {
                    console.log('模拟复制文件到文件夹:', { items, targetPath });
                    // 模拟异步操作
                    await new Promise(resolve => setTimeout(resolve, 1000));
                    return {
                        success: true,
                        message: `复制完成: 成功 ${items.length} 个，失败 0 个`,
                        results: items.map(item => ({
                            fileName: item.fileName,
                            success: true,
                            targetPath: `${targetPath}/${item.fileName}`
                        })),
                        successCount: items.length,
                        errorCount: 0
                    };
                },
                getDesktopPath: async () => {
                    return {
                        success: true,
                        path: '~/Desktop'
                    };
                }
            }
        };

        // 模拟toast函数
        window.showToast = (message, type) => {
            alert(`${type === 'success' ? '成功' : '错误'}: ${message}`);
        };

        // 初始化媒体卡片
        document.addEventListener('DOMContentLoaded', () => {
            const mediaContainer = document.getElementById('media-card-container');
            
            if (typeof MediaCard !== 'undefined') {
                const mediaCard = new MediaCard();
                mediaCard.init(mediaContainer, testMediaItems, {
                    goodsId: 'test-goods-123',
                    onSelectionChange: (selectedItems) => {
                        console.log('媒体选择变化:', selectedItems);
                    },
                    onImageClick: (image, index) => {
                        console.log('图片点击:', image);
                    },
                    onVideoContextMenu: (event, index, fileName, filePath) => {
                        console.log('视频右键菜单:', fileName);
                    }
                });
            } else {
                mediaContainer.innerHTML = '<div class="no-media">MediaCard组件未加载</div>';
            }
        });
    </script>
</body>
</html>
