<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>滚动修复测试</title>
    <link rel="stylesheet" href="../renderer/styles.css">
    <link rel="stylesheet" href="../renderer/icons-fixed.css">
    <style>
        body {
            margin: 0;
            padding: 0;
            height: 100vh;
            overflow: hidden;
        }
        
        .test-container {
            height: 100vh;
            display: flex;
            flex-direction: column;
            font-family: system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
        }
        
        .test-header {
            height: 48px;
            background-color: var(--color-background);
            border-bottom: 1px solid var(--color-border);
            display: flex;
            align-items: center;
            padding: 0 24px;
            flex-shrink: 0;
        }
        
        .test-main-layout {
            flex: 1;
            display: flex;
            overflow: hidden;
        }
        
        .test-sidebar {
            width: 200px;
            background-color: var(--color-muted);
            border-right: 1px solid var(--color-border);
            padding: 16px;
            flex-shrink: 0;
        }
        
        .test-page-container {
            flex: 1;
            background-color: var(--color-page-container-background);
            border-radius: 16px;
            overflow: auto;
            margin: 16px;
            padding: 0;
        }
        
        .test-product-library-page {
            padding: 24px;
            height: 100%;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
        }
        
        .test-page-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 24px;
            flex-shrink: 0;
        }
        
        .test-product-table-container {
            background: var(--color-card-background);
            border-radius: 8px;
            border: 1px solid var(--color-border);
            overflow: auto;
            margin-bottom: 24px;
            flex: 1;
            min-height: 0;
        }
        
        .test-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 14px;
        }
        
        .test-table th,
        .test-table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid var(--color-border);
        }
        
        .test-table th {
            background: var(--color-muted);
            font-weight: 600;
            color: var(--color-text-primary);
        }
        
        .test-table td {
            color: var(--color-text-secondary);
        }
        
        .test-info {
            background-color: var(--color-hover);
            border: 1px solid var(--color-border);
            border-radius: 6px;
            padding: 15px;
            margin-bottom: 20px;
            font-size: 14px;
            color: var(--color-text-secondary);
        }
        
        .scroll-indicator {
            position: fixed;
            top: 60px;
            right: 20px;
            background-color: var(--color-card-background);
            border: 1px solid var(--color-border);
            border-radius: 6px;
            padding: 10px;
            font-size: 12px;
            color: var(--color-text-secondary);
            z-index: 1000;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <!-- 测试头部 -->
        <div class="test-header">
            <h1>滚动修复测试</h1>
        </div>
        
        <!-- 主布局 -->
        <div class="test-main-layout">
            <!-- 侧边栏 -->
            <div class="test-sidebar">
                <h3>侧边栏</h3>
                <p>模拟侧边栏内容</p>
            </div>
            
            <!-- 页面容器 -->
            <div class="test-page-container">
                <div class="test-product-library-page">
                    <div class="test-info">
                        <strong>测试说明：</strong><br>
                        这个页面模拟了产品库页面的布局结构。<br>
                        表格容器应该可以滚动，包含20行测试数据。<br>
                        右侧显示滚动位置信息。
                    </div>
                    
                    <div class="test-page-header">
                        <h2>产品库测试</h2>
                        <div>共 20 个产品</div>
                    </div>
                    
                    <div class="test-product-table-container">
                        <table class="test-table">
                            <thead>
                                <tr>
                                    <th>产品标题</th>
                                    <th>昨日销量</th>
                                    <th>价格增长</th>
                                    <th>采集日期</th>
                                </tr>
                            </thead>
                            <tbody>
                                <!-- 生成20行测试数据 -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- 滚动位置指示器 -->
    <div class="scroll-indicator" id="scroll-indicator">
        <div>滚动位置: <span id="scroll-position">0</span></div>
        <div>容器高度: <span id="container-height">0</span></div>
        <div>内容高度: <span id="content-height">0</span></div>
        <div>可滚动: <span id="scrollable">否</span></div>
    </div>

    <script>
        // 生成测试数据
        function generateTestData() {
            const tbody = document.querySelector('.test-table tbody');
            const testProducts = [
                'Boundless Voyage纯钛户外锅铲',
                '便携式野营炒菜铲子',
                '轻量级饭勺套装',
                '户外烹饪工具包',
                '钛合金餐具组合',
                '野营必备厨具',
                '户外便携锅具',
                '野餐烹饪工具',
                '露营餐具套装',
                '户外厨房用品',
                '便携式炊具',
                '野营炒锅套装',
                '户外烧烤工具',
                '野餐必备用品',
                '露营烹饪设备',
                '便携式炉具',
                '户外餐具组合',
                '野营厨房工具',
                '钛制烹饪用具',
                '户外野餐套装'
            ];
            
            for (let i = 0; i < 20; i++) {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${testProducts[i] || `测试产品 ${i + 1}`}</td>
                    <td>${Math.floor(Math.random() * 1000) + 50}</td>
                    <td>${(Math.random() > 0.5 ? '+' : '-') + (Math.random() * 10).toFixed(1)}%</td>
                    <td>2025-01-${String(14 - i).padStart(2, '0')}</td>
                `;
                tbody.appendChild(row);
            }
        }
        
        // 更新滚动指示器
        function updateScrollIndicator() {
            const tableContainer = document.querySelector('.test-product-table-container');
            const scrollPosition = tableContainer.scrollTop;
            const containerHeight = tableContainer.clientHeight;
            const contentHeight = tableContainer.scrollHeight;
            const isScrollable = contentHeight > containerHeight;
            
            document.getElementById('scroll-position').textContent = Math.round(scrollPosition);
            document.getElementById('container-height').textContent = Math.round(containerHeight);
            document.getElementById('content-height').textContent = Math.round(contentHeight);
            document.getElementById('scrollable').textContent = isScrollable ? '是' : '否';
            
            // 根据是否可滚动改变颜色
            const scrollableElement = document.getElementById('scrollable');
            if (isScrollable) {
                scrollableElement.style.color = '#28ca42';
            } else {
                scrollableElement.style.color = '#ff5f57';
            }
        }
        
        // 页面加载完成后初始化
        document.addEventListener('DOMContentLoaded', () => {
            // 生成测试数据
            generateTestData();
            
            // 添加滚动监听器
            const tableContainer = document.querySelector('.test-product-table-container');
            tableContainer.addEventListener('scroll', updateScrollIndicator);
            
            // 初始更新
            updateScrollIndicator();
            
            // 定期更新（处理窗口大小变化）
            setInterval(updateScrollIndicator, 1000);
            
            console.log('滚动测试页面已加载');
            console.log('表格容器:', tableContainer);
            console.log('容器高度:', tableContainer.clientHeight);
            console.log('内容高度:', tableContainer.scrollHeight);
        });
    </script>
</body>
</html>
